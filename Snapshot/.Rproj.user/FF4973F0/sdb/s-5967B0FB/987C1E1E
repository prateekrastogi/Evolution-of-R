{
    "contents" : "#database frame\ndframe <-function(fvector,rversion,os)\n{\n  pkgname<-package(fvector)\n  print(pkgname)\n  pkgversion<-version(fvector)\n  # if pkgname and version both are present\n  if(length(pkgname)>0 && length(pkgversion)>0)\n  { \n    channel<-intdb()\n    #for checking whether package is in package table or not\n    data<-sqlFetch(channel,'package',colnames=F,rownames=F)\n    data2<-sqlFetch(channel,'pkgname',colnames=F,rownames=F)\n    temp<-match(pkgname,data2[,2],nomatch=-1)\n    temp2<-match(pkgversion,data[,4],nomatch=-1)\n    # if match occurs i.e. package name is present in package table\n    if(temp!=-1)\n    { \n      temp<-match(data2[,1][temp[1]],data[,2])\n      t<-setdiff(temp,setdiff(temp,temp2))\n      # to confirm that it is the intended package version i.e. match is perfect\n      if(length(t)>0 && t!=-1)\n      {\n        pkgid<-data[,1][t[1]]  #pkgid\n        # for checking whether package is already in the snap or not\n        tp<-sqlFetch(channel,'snap',colnames=F,rownames=F)\n        tid<-match(pkgid,tp[,1],nomatch=-1)\n        tversion<-match(pkgversion,tp[,2],nomatch=-1)\n        tr<-match(rversion,tp[,3],nomatch=-1)\n        tiv<-setdiff(tid,setdiff(tid,tversion))\n        tir<-setdiff(tid,setdiff(tid,tr))\n        finaldiff<-setdiff(tid,setdiff(tir,tiv))  \n        if(length(finaldiff)==0 || finaldiff ==-1)   #package not already present in snap\n      {\n        pkgversion<-pkgversion\n        pkgos<-os\n        dta2<-data.frame(pkgid,os)\n        names(dta2)<-c(\"idos\",\"os\")\n        dta<-data.frame(pkgid,pkgversion,rversion)\n        names(dta)<-c(\"pkgid\",\"version\",\"rversion\")\n        try(test<-sqlSave(channel,dta,tablename='snap',append=T,rownames=F,colnames=F,fast=F))\n        if(test==1)\n        {\n          try(sqlSave(channel,dta2,tablename='os',append=T,rownames=F,colnames=F,fast=F))\n        }\n      }\n        #if package is already present in the snap table of the database \n        else\n        {\n           tdata<-sqlFetch(channel,'os',colnames=F,rownames=F) \n           # if os are different then only add os to the os table\n         if(length(tdata[,2])>0)\n         {timepass<-tdata[,2][finaldiff[1]]\n        \n         if(length(timepass)>0 )\n           {if(os!=timepass)\n           {\n             dta<-data.frame(pkgid,os)\n             names(dta)<-c(\"idos\",\"os\")\n             try(sqlSave(channel,dta,tablename='os',append=T,rownames=F,colnames=F,fast=F))\n           }\n        }}\n        else\n        {\n          dta<-data.frame(pkgid,os)\n          names(dta)<-c(\"idos\",\"os\")\n          try(sqlSave(channel,dta,tablename='os',append=T,rownames=F,colnames=F,fast=F))\n        }\n        }\n      }\n    }\n  closedb()\n  }\n  \n}\n# to initialize the database connection to our desired database\nintdb<-function()\n{\n  channel<- odbcConnect('r',uid=\"root\",pwd=\"root\")\n  sqlQuery(channel,\"use finaldb;\")\n  return(channel)\n}\n# to close database connection\nclosedb <-function()\n{\n  odbcCloseAll()\n}",
    "created" : 1373901355988.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2008149569",
    "id" : "987C1E1E",
    "lastKnownWriteTime" : 1373901358,
    "path" : "E:/R/Snapshot/R/Database.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : true,
    "type" : "r_source"
}